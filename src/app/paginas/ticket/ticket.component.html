<div class="ticket-page">

  <div class="ticket-box" *ngIf="ticket; else noTicket">

    <h1 class="titulo-ticket">Ticket de Compra</h1>

    <!-- INFO GENERAL -->
    <div class="info-block">
      <p><strong>NÂ° Ticket:</strong> {{ ticket.numero_ticket }}</p>
      <p><strong>Fecha:</strong> {{ ticket.fecha | date:'dd/MM/yyyy HH:mm' }}</p>
    </div>

    <!-- DATOS DEL CLIENTE -->
    <div class="ticket-section">
      <h3>Datos del Cliente</h3>

      <p><strong>Nombre:</strong> {{ ticket.cliente?.nombre }}</p>
      <p><strong>Correo:</strong> {{ ticket.cliente?.correo }}</p>
    </div>

    <!-- PRODUCTOS -->
    <div class="ticket-section">
      <h3>Productos Comprados</h3>

      <table class="productos-table">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cant.</th>
            <th>Precio</th>
            <th>Subtotal</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let p of ticket.detalles">
            <td>{{ p.nombre }}</td>
            <td>{{ p.cantidad }}</td>
            <td>${{ p.precio }}</td>
            <td>${{ p.subtotal }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- TOTALES -->
    <div class="ticket-section total-section">
      <h2><strong>Total:</strong> ${{ ticket.total }}</h2>
    </div>

    <!-- BOTONES -->
    <div class="btn-group-ticket">
      <button class="btn-descargar" (click)="descargarPDF()">
        Descargar Ticket PDF
      </button>

      <a routerLink="/" class="btn-volver">Volver al inicio</a>
    </div>

    <!-- MOSTRAR PDF -->
    <div class="pdf-container">
      <iframe [src]="pdfUrl" class="pdf-frame"></iframe>
    </div>

  </div>

  <!-- SI NO EXISTE TICKET -->
  <ng-template #noTicket>
    <div class="ticket-box not-found">
      <h2 class="titulo-ticket">Ticket no encontrado</h2>
      <p>No existe ticket asociado a esta compra.</p>
      <a routerLink="/" class="btn-volver">Volver a la tienda</a>
    </div>
  </ng-template>

</div>
