<div class="carrito-page">
  <div class="carrito-box">
    
    <h1 class="titulo-carrito">Carrito de Compras</h1>

    <!-- CARRITO VACÍO -->
    <div *ngIf="productosEnCarrito.length === 0" class="carrito-vacio">
      <p>Tu carrito está vacío</p>
    </div>

    <!-- TABLA DEL CARRITO -->
    <table class="carrito-table" *ngIf="productosEnCarrito.length > 0">

      <thead>
        <tr>
          <th>Imagen</th>
          <th>Producto</th>
          <th>Talle</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th>Eliminar</th>
          <th>Total</th>
        </tr>
      </thead>

      <tbody>

        <tr *ngFor="let item of productosEnCarrito; let i = index">

          <!-- IMAGEN -->
          <td data-label="Imagen">
            <img class="carrito-img" [src]="item.producto.imagen" alt="Imagen producto" />
          </td>

          <!-- NOMBRE -->
          <td data-label="Producto" class="producto-nombre">
            {{ item.producto.nombre }}
          </td>

          <!-- TALLE -->
          <td data-label="Talle">
            {{ item.talle }}
          </td>

          <!-- PRECIO -->
          <td data-label="Precio" class="precio">
            ${{ item.precio_unitario ?? item.producto.precio }}
          </td>

          <!-- CANTIDAD -->
          <td data-label="Cantidad">
            <div class="qty-box">
              <button class="qty-btn" (click)="quitarCantidad(i)">−</button>
              <span class="qty-num">{{ item.cantidad }}</span>
              <button class="qty-btn" (click)="agregarCantidad(i)">+</button>
            </div>
          </td>

          <!-- ELIMINAR -->
          <td data-label="Eliminar">
            <button class="btn-eliminar" (click)="eliminarProducto(item.id_detalle!)">
              <i class="bi bi-trash3"></i> Eliminar Producto
            </button>
          </td>

          <!-- TOTAL -->
          <td data-label="Total" class="precio-total">
            ${{ item.cantidad * (item.precio_unitario ?? item.producto.precio) }}
          </td>

        </tr>

      </tbody>
    </table>

    <!-- TOTAL GENERAL -->
    <div class="total-box" *ngIf="productosEnCarrito.length > 0">

      <h4 class="total-text">
        Total: 
        <span class="total-num">${{ calcularTotal() }}</span>
      </h4>

      <button class="btn-compra" (click)="irAFormularioCompra()">
        <i class="bi bi-cart-check"></i> Realizar compra
      </button>

    </div>

  </div>
</div>
