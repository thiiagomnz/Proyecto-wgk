<div class="carrito-page">
  <div class="carrito-box">
    <h1>Carrito de Compras</h1>

    <div *ngIf="productosEnCarrito.length === 0">
      <p>No hay productos en el carrito</p>
    </div>

    <table class="table" *ngIf="productosEnCarrito.length > 0">
      <thead>
        <tr>
          <th>Imagen</th>
          <th>Nombre</th>
          <th>Talle</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th>Acciones</th>
          <th>Total</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let item of productosEnCarrito; let i = index">
          <td><img [src]="item.producto.imagen" /></td>

          <td>{{ item.producto.nombre }}</td>

          <td>{{ item.talle }}</td>

         <td>$ {{ item.precio_unitario ?? item.producto.precio }}</td>

          <td>
            <button (click)="quitarCantidad(i)">âˆ’</button>
            {{ item.cantidad }}
            <button (click)="agregarCantidad(i)">+</button>
          </td>

          <td>
            <button (click)="eliminarProducto(item.id_detalle!)">
              Eliminar
            </button>
          </td>

          <td>$ {{ item.cantidad * (item.precio_unitario ?? item.producto.precio) }}</td>
        </tr>
      </tbody>
    </table>

    <div class="total-box" *ngIf="productosEnCarrito.length > 0">
      <h4>Total: ${{ calcularTotal() }}</h4>

      <button (click)="irAFormularioCompra()">
        <i class="bi bi-cart-check"></i> Realizar compra
      </button>
    </div>

  </div>
</div>
