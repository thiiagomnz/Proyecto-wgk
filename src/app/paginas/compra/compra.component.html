<div class="compra-wrapper">

  <h2 class="titulo-compra">Formulario de Compra</h2>

  <form [formGroup]="formularioCompra" (ngSubmit)="finalizarCompra()" class="form-wgk">

    <!-- ======================
         üüß NOMBRE + TEL√âFONO
         ====================== -->
    <div class="row-wgk">
      <div class="input-box">
        <label>Nombre y apellido <span>*</span></label>
        <div class="input-group-wgk">
          <i class="bi bi-person-fill"></i>
          <input formControlName="nombre" placeholder="Tu nombre completo">
        </div>
        <small *ngIf="formularioCompra.get('nombre')?.touched && formularioCompra.get('nombre')?.invalid">
          El nombre es obligatorio
        </small>
      </div>

      <div class="input-box">
        <label>Tel√©fono <span>*</span></label>
        <div class="input-group-wgk">
          <i class="bi bi-telephone-fill"></i>
          <input formControlName="telefono" placeholder="Ej: +54 9 11 1234 5678">
        </div>
        <small *ngIf="formularioCompra.get('telefono')?.touched && formularioCompra.get('telefono')?.invalid">
          El tel√©fono es obligatorio
        </small>
      </div>
    </div>

    <!-- ======================
         üüß EMAIL
         ====================== -->
    <div class="input-box">
      <label>Email <span>*</span></label>
      <div class="input-group-wgk">
        <i class="bi bi-envelope-fill"></i>
        <input type="email" formControlName="correo" placeholder="ejemplo@mail.com">
      </div>
      <small *ngIf="formularioCompra.get('correo')?.touched && formularioCompra.get('correo')?.invalid">
        Correo inv√°lido u obligatorio
      </small>
    </div>

    <!-- ======================
         üüß DIRECCI√ìN
         ====================== -->
    <div class="input-box">
      <label>Direcci√≥n <span>*</span></label>
      <div class="input-group-wgk">
        <i class="bi bi-geo-alt-fill"></i>
        <input formControlName="direccion" placeholder="Calle, n√∫mero, piso, depto">
      </div>
      <small *ngIf="formularioCompra.get('direccion')?.touched && formularioCompra.get('direccion')?.invalid">
        La direcci√≥n es obligatoria
      </small>
    </div>

    <!-- ======================
         üüß CIUDAD / PROVINCIA / CP
         ====================== -->
    <div class="row-wgk">
      <div class="input-box">
        <label>Ciudad <span>*</span></label>
        <input formControlName="ciudad" placeholder="Ej: Neuqu√©n">
        <small *ngIf="formularioCompra.get('ciudad')?.touched && formularioCompra.get('ciudad')?.invalid">
          Campo obligatorio
        </small>
      </div>

      <div class="input-box">
        <label>Provincia <span>*</span></label>
        <input formControlName="provincia" placeholder="Ej: Neuqu√©n">
        <small *ngIf="formularioCompra.get('provincia')?.touched && formularioCompra.get('provincia')?.invalid">
          Campo obligatorio
        </small>
      </div>

      <div class="input-box">
        <label>C√≥digo Postal <span>*</span></label>
        <input formControlName="codigoPostal" placeholder="Ej: 8300">
        <small *ngIf="formularioCompra.get('codigoPostal')?.touched && formularioCompra.get('codigoPostal')?.invalid">
          Campo obligatorio
        </small>
      </div>
    </div>

    <!-- ======================
         üüß M√âTODO DE PAGO
         ====================== -->
    <div class="input-box">
      <label>M√©todo de Pago <span>*</span></label>
      <select formControlName="metodoPago" class="select-wgk">
        <option value="" disabled selected>Seleccione m√©todo de pago</option>
        <option value="efectivo">Efectivo</option>
        <option value="transferencia">Transferencia</option>
      </select>

      <small *ngIf="formularioCompra.get('metodoPago')?.touched && formularioCompra.get('metodoPago')?.invalid">
        Selecciona un m√©todo de pago.
      </small>

      <!-- üîµ BOX TRANSFERENCIA -->
      <div *ngIf="formularioCompra.get('metodoPago')?.value === 'transferencia'" class="transfer-box">
        <p>
          <strong>Alias:</strong> thiago.mnz07
          <button type="button" (click)="copiarTexto('thiago.mnz07')" class="btn-copy">Copiar</button>
        </p>
        <p>
          <strong>Enviar comprobante:</strong> 2995746460
          <button type="button" (click)="copiarTexto('2995746460')" class="btn-copy">Copiar</button>
        </p>
      </div>
    </div>

    <!-- ======================
         üüß TOTAL + BOT√ìN
         ====================== -->
    <div class="total-section">
      <p>Env√≠o: ${{ envio }}</p>
      <h3>Total: ${{ total }}</h3>

      <button type="submit" class="btn-finalizar">Finalizar Compra</button>
    </div>

  </form>
</div>

<!-- ======================
     üüß MODAL PDF
     ====================== -->
<div *ngIf="mostrarModal" class="modal-wgk">
  <div class="modal-content-wgk">

    <div class="modal-header-wgk">
      <h4>Factura PDF</h4>
      <button (click)="cerrarModal()">‚úï</button>
    </div>

    <iframe *ngIf="pdfSrc" [src]="pdfSrc" id="pdfFrame"></iframe>

    <div class="modal-footer-wgk">
      <button class="btn-print" (click)="imprimirPDF()">Imprimir</button>
      <button class="btn-close" (click)="cerrarModal()">Cerrar</button>
    </div>

  </div>
</div>
